const data = [
    ["2020-12-27",1257,0,0],
    ["2020-12-28",2283,0,0],
    ["2020-12-29",3457,0,0],
    ["2020-12-30",3463,0,0],
    ["2020-12-31",1304,0,0],
    ["2021-01-01",262,0,0],
    ["2021-01-02",1256,0,0],
    ["2021-01-03",915,0,0],
    ["2021-01-04",3566,0,0],
    ["2021-01-05",4504,0,0],
    ["2021-01-06",5797,0,0],
    ["2021-01-07",7924,0,0],
    ["2021-01-08",9933,0,0],
    ["2021-01-09",1990,0,0],
    ["2021-01-10",1711,0,0],
    ["2021-01-11",9731,0,0],
    ["2021-01-12",13340,0,0],
    ["2021-01-13",13443,0,0],
    ["2021-01-14",15025,0,0],
    ["2021-01-15",13672,0,0],
    ["2021-01-16",3314,0,0],
    ["2021-01-17",2434,622,0],
    ["2021-01-18",11981,1772,0],
    ["2021-01-19",11985,2683,0],
    ["2021-01-20",12917,2567,0],
    ["2021-01-21",14878,1705,0],
    ["2021-01-22",14298,995,0],
    ["2021-01-23",2817,836,0],
    ["2021-01-24",2202,854,1257],
    ["2021-01-25",9452,2904,2283],
    ["2021-01-26",10261,3928,3457],
    ["2021-01-27",8783,4456,3463],
    ["2021-01-28",6993,6034,1304],
    ["2021-01-29",6000,7703,262],
    ["2021-01-30",714,1067,1256],
    ["2021-01-31",695,1120,915],
    ["2021-02-01",3651,7632,3566],
    ["2021-02-02",3936,9826,4504],
    ["2021-02-03",4226,10716,5797],
    ["2021-02-04",4335,12576,7924],
    ["2021-02-05",4125,9700,9933],
    ["2021-02-06",813,1733,1990],
    ["2021-02-07",797,1827,1711],
    ["2021-02-08",0,0,9731],
    ["2021-02-09",0,0,13340],
    ["2021-02-10",0,0,13443],
    ["2021-02-11",0,0,15025],
    ["2021-02-12",0,0,13672],
    ["2021-02-13",0,0,3314],
    ["2021-02-14",0,0,2434],
    ["2021-02-15",0,0,11981],
    ["2021-02-16",0,0,11985],
    ["2021-02-17",0,0,12917],
    ["2021-02-18",0,0,14878],
    ["2021-02-19",0,0,14298],
    ["2021-02-20",0,0,2817],
    ["2021-02-21",0,0,2202],
    ["2021-02-22",0,0,9452],
    ["2021-02-23",0,0,10261],
    ["2021-02-24",0,0,8783],
    ["2021-02-25",0,0,6993],
    ["2021-02-26",0,0,6000],
    ["2021-02-27",0,0,714],
    ["2021-02-28",0,0,695],
    ["2021-03-01",0,0,3651],
    ["2021-03-02",0,0,3936],
    ["2021-03-03",0,0,4226],
    ["2021-03-04",0,0,4335],
    ["2021-03-05",0,0,4125],
    ["2021-03-06",0,0,813],
    ["2021-03-07",0,0,797],
];
// den, prvni, druha, druha_plan

Highcharts.setOptions({
    lang: {
        numericSymbols: [" tis.", " mil.", " mld.", "T", "P", "E"]
    }
});

function niceNum(val) {
    return val.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ' ');
}

Highcharts.chart('vak_druha_graf', {
    chart: {
        type: 'column',
        spacing: [10, 0, 15, 0]
    },
    title: {
        text: 'Aplikované a plánované dávky očkování'
    },
    subtitle: {
        text: 'počítáno 28 dní mezi dávkami'
    },
    xAxis: {
        categories: data.map((d) => d[0]),
        crosshair: true,
        labels: {
            formatter: function() {
                const parts = this.value.split('-')
                return parseInt(parts[2]) + '. ' + parseInt(parts[1]) + '.'
            }
        },
    },
    credits: {
        text: 'Zdroj: ÚZIS',
        href: 'https://onemocneni-aktualne.mzcr.cz/api/v2/covid-19',
    },
    yAxis: {
        min: 0,
        title: {
            text: 'počet dávek'
        }
    },
    tooltip: {
        formatter: function() {
            const dt = this.x.split('-')
            return `<b>${parseInt(dt[2])}. ${parseInt(dt[1])}. ${parseInt(dt[0])}</b><br>` +
            `Prvních dávek: ${niceNum(this.points[0].y)}<br>` +
            `Druhých dávek: ${niceNum(this.points[1].y)}<br>` +
            `Druhých dávek v plánu: ${niceNum(this.points[2].y)}`
        },
        shared: true,
        useHTML: true
    },
    plotOptions: {
        column: {
            pointPadding: 0.2,
            borderWidth: 0
        }
    },
    series: [{
        name: 'První dávky',
        data: data.map((d) => d[1]),
        color: '#3182bd',
    }, {
        name: 'Druhé dávky',
        data: data.map((d) => d[2]),
        color: '#de2d26',

    }, {
        name: 'Plánované druhé dávky',
        data: data.map((d) => d[3]),
        color: '#fc9272',
    }]
});